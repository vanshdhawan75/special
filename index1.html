<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Our Universe</title>

<style>
body { margin:0; overflow:hidden; background:black; font-family:'Segoe UI',sans-serif; }
#overlay { position:absolute; top:0; width:100%; text-align:center; color:white; padding-top:40px; z-index:10; pointer-events:none; transition:1s; }
#proposalBox { position:absolute; bottom:80px; width:100%; text-align:center; display:none; z-index:20; transition:1s; }
#orbitText { position:absolute; top:40%; width:100%; text-align:center; color:white; font-size:28px; display:none; z-index:20; transition:1s; }
#burstText { position:absolute; bottom:15%; width:100%; text-align:center; color:#ffccdd; font-size:32px; font-weight:bold; text-shadow:0 0 15px rgba(255,100,150,0.8); opacity:0; transition:opacity 2s ease-in-out; z-index:25; pointer-events:none; }
#envelopeTextContainer {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 800px;
    text-align: center;
    color: #ffe6f0;
    font-size: 24px;
    font-weight: 400;
    line-height: 1.8;
    letter-spacing: 1.2px;
    text-shadow: 0 0 15px rgba(255, 100, 200, 0.7);
    opacity: 0;
    transition: opacity 3s ease-in;
    pointer-events: none;
    z-index: 28;
    padding: 20px;
}
#envelopeTextContainer.show { opacity: 1; }
#finalPromise {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 900px;
    text-align: center;
    color: #fff;
    font-size: 36px;
    font-weight: 600;
    line-height: 1.5;
    text-shadow: 0 0 30px #ff1493, 0 0 60px #ff69b4;
    opacity: 0;
    transition: opacity 4s ease-in;
    pointer-events: none;
    z-index: 40;
}
#bouquetFinal {
    position: absolute;
    top: 60%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    width: 350px;
    height: 350px;
    opacity: 0;
    transition: opacity 5s, transform 12s;
    z-index: 50;
    pointer-events: none;
}
#bouquetFinal div {
    font-size: 220px;
    text-align: center;
    filter: drop-shadow(0 0 40px #ff69b4);
}
#backToOrbit { position:absolute; top:20px; left:20px; background:#4d9aff; color:white; padding:12px 25px; border-radius:25px; border:none; cursor:pointer; font-size:16px; display:none; z-index:30; }
button { padding:12px 25px; margin:10px; border-radius:25px; border:none; cursor:pointer; font-size:16px; }
#enterOrbit { position:absolute; top:20px; right:20px; background:#ff4d6d; color:white; z-index:10; }
#yesBtn { background:#ff4d88; color:white; }
#noBtn { background:white; position:relative; }
.flower-msg {
    position: absolute;
    color: #fff0f5;
    font-size: 22px;
    text-shadow: 0 0 15px #ff69b4;
    pointer-events: none;
    opacity: 0;
    transition: opacity 1.5s, transform 4s;
}
</style>
</head>

<body>

<button id="enterOrbit">Enter Our Orbit üí´</button>
<button id="backToOrbit">Back to Orbit ‚Ü∫</button>

<div id="overlay">
    <h1>Out of 8 Billion People...</h1>
    <p>My universe chose you.</p>
</div>

<div id="proposalBox">
    <h2>Will you be mine forever? üíç</h2>
    <button id="yesBtn">Yes ‚ù§Ô∏è</button>
    <button id="noBtn">No üíî</button>
</div>

<div id="orbitText">This is how you got me moving around here heerüí´</div>

<div id="burstText">High on you always üí´</div>

<div id="envelopeTextContainer">
tenu hi chaune a bakia da vel kithe,<br><br>
being your,s from the past till there will the sun ,<br><br>
not only for your beauty but for the human you are<br><br>
isha loveee you sooooo muchhhhh üíñ
</div>

<div id="finalPromise"></div>

<div id="bouquetFinal">
    <div>üåπüíêüå∏</div>
</div>

<audio id="bgMusic" loop>
    <source src="song.mp3" type="audio/mp3">
</audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

<script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 3000);
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

camera.position.set(0, 0, 10);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.08;
controls.enablePan = true;
controls.minDistance = 3;
controls.maxDistance = 2000;

// Stars
const starGeometry = new THREE.BufferGeometry();
const starCount = 6000;
const starPositions = new Float32Array(starCount * 3);
for (let i = 0; i < starCount * 3; i++) starPositions[i] = (Math.random() - 0.5) * 2200;
starGeometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
const stars = new THREE.Points(starGeometry, new THREE.PointsMaterial({ color: 0xffffff, size: 1.2 }));
scene.add(stars);

// Floating photos
const textureLoader = new THREE.TextureLoader();
const photo1 = textureLoader.load("photo1.jpg");
const photo2 = textureLoader.load("photo2.jpg");
const planeGeo = new THREE.PlaneGeometry(5, 3);
const plane1 = new THREE.Mesh(planeGeo, new THREE.MeshBasicMaterial({ map: photo1 }));
const plane2 = new THREE.Mesh(planeGeo, new THREE.MeshBasicMaterial({ map: photo2 }));
plane1.position.set(-8, 2, -20);
plane2.position.set(8, -2, -30);
scene.add(plane1, plane2);

// Orbit
let orbitMode = false;
let sun = null, earth = null, angle = 0;

function createOrbit() {
    if (sun || earth) return;
    const her = textureLoader.load("her.png");
    const you = textureLoader.load("him.png");
    sun = new THREE.Mesh(new THREE.CircleGeometry(2,64), new THREE.MeshBasicMaterial({map:her, transparent:true}));
    earth = new THREE.Mesh(new THREE.CircleGeometry(0.8,64), new THREE.MeshBasicMaterial({map:you, transparent:true}));
    scene.add(sun, earth);
}

function removeOrbit() {
    if (sun) scene.remove(sun);
    if (earth) scene.remove(earth);
    sun = earth = null;
}

const bgMusic = document.getElementById("bgMusic");

document.getElementById("enterOrbit").addEventListener("click", () => {
    orbitMode = true;
    document.getElementById("overlay").style.opacity = "0";
    document.getElementById("proposalBox").style.opacity = "0";
    document.getElementById("enterOrbit").style.display = "none";
    setTimeout(() => {
        document.getElementById("overlay").style.display = "none";
        document.getElementById("proposalBox").style.display = "none";
    }, 1000);

    document.getElementById("orbitText").style.display = "block";
    document.getElementById("orbitText").style.opacity = "1";

    bgMusic.play().catch(()=>{});
    createOrbit();
});

// Heart Nebula
let nebulaParticles = null;
function createNebula() {
    if (nebulaParticles) return;
    const count = 8000;
    const geo = new THREE.BufferGeometry();
    const pos = new Float32Array(count * 3);
    const col = new Float32Array(count * 3);
    const size = new Float32Array(count);

    for (let i = 0; i < count; i++) {
        const i3 = i * 3;
        const t = Math.random() * Math.PI * 2;
        const scale = 18 + Math.random() * 35;
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
        const z = (Math.random() - 0.5) * 80;

        pos[i3]     = x * scale * 0.9 + (Math.random() - 0.5) * 40;
        pos[i3 + 1] = y * scale * 0.75 + (Math.random() - 0.5) * 30;
        pos[i3 + 2] = z;

        const mix = Math.random();
        let c = mix < 0.4 ? new THREE.Color(0xff1a5c) : mix < 0.75 ? new THREE.Color(0xff66aa) : new THREE.Color(0xcc88ff);
        col[i3] = c.r; col[i3+1] = c.g; col[i3+2] = c.b;

        size[i] = 6 + Math.random() * 12;
    }

    geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
    geo.setAttribute('color', new THREE.BufferAttribute(col, 3));
    geo.setAttribute('size', new THREE.BufferAttribute(size, 1));

    const mat = new THREE.PointsMaterial({
        vertexColors: true,
        sizeAttenuation: true,
        transparent: true,
        opacity: 0.6,
        blending: THREE.AdditiveBlending,
        depthWrite: false
    });

    nebulaParticles = new THREE.Points(geo, mat);
    scene.add(nebulaParticles);
}

// Flying Heart
let flyingHeart = null;
function createFlyingHeart() {
    if (flyingHeart) return;

    const group = new THREE.Group();

    const hitGeo = new THREE.SphereGeometry(18, 16, 16);
    const hitMat = new THREE.MeshBasicMaterial({ visible: false });
    const hitbox = new THREE.Mesh(hitGeo, hitMat);
    group.add(hitbox);

    const shape = new THREE.Shape();
    shape.moveTo(0, 5);
    shape.bezierCurveTo(5, 10, 10, 5, 10, 0);
    shape.bezierCurveTo(10, -5, 5, -10, 0, -10);
    shape.bezierCurveTo(-5, -10, -10, -5, -10, 0);
    shape.bezierCurveTo(-10, 5, -5, 10, 0, 5);

    const extrude = { depth: 1, bevelEnabled: true, bevelThickness: 0.5, bevelSize: 0.5 };
    const geo = new THREE.ExtrudeGeometry(shape, extrude);
    const mat = new THREE.MeshBasicMaterial({ color: 0xff1493 });
    const heart = new THREE.Mesh(geo, mat);
    heart.scale.set(2.5, 2.5, 1);
    heart.rotation.x = Math.PI / 2;
    group.add(heart);

    const glow = new THREE.Mesh(
        new THREE.SphereGeometry(12, 32, 32),
        new THREE.MeshBasicMaterial({ color: 0xff69b4, transparent: true, opacity: 0.6 })
    );
    group.add(glow);

    group.position.set(-120, 30, -150);
    scene.add(group);
    flyingHeart = group;
}

// Flower Planet
let flowerPlanet = null;
let planetClickCount = 0;
const flowerMessages = [
    "Vansh loves Isha more than anything in this universe ‚ù§Ô∏è",
    "You are the most gorgeous girl I've ever seen ‚ú®",
    "Your smile lights up my entire world, Isha üí´",
    "Every moment with you feels like magic üå∏",
    "I can't imagine life without you, my love üíç",
    "You're perfect in every way, Isha üòç"
];

function createFlowerPlanet() {
    if (flowerPlanet) return;

    const planetGeo = new THREE.SphereGeometry(25, 64, 64);
    const planetMat = new THREE.MeshBasicMaterial({ color: 0x4CAF50 });
    flowerPlanet = new THREE.Mesh(planetGeo, planetMat);
    flowerPlanet.position.set(0, 0, -220);
    scene.add(flowerPlanet);

    const count = 5000;
    const fGeo = new THREE.BufferGeometry();
    const fPos = new Float32Array(count * 3);
    const fCol = new Float32Array(count * 3);
    for (let i = 0; i < count; i++) {
        const i3 = i * 3;
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.acos(2 * Math.random() - 1);
        const r = 25.8;
        fPos[i3]     = r * Math.sin(phi) * Math.cos(theta);
        fPos[i3 + 1] = r * Math.sin(phi) * Math.sin(theta);
        fPos[i3 + 2] = r * Math.cos(phi);

        const mix = Math.random();
        let c = mix < 0.3 ? new THREE.Color(0xff69b4) : mix < 0.6 ? new THREE.Color(0xff1493) : new THREE.Color(0xffffff);
        fCol[i3] = c.r; fCol[i3+1] = c.g; fCol[i3+2] = c.b;
    }
    fGeo.setAttribute('position', new THREE.BufferAttribute(fPos, 3));
    fGeo.setAttribute('color', new THREE.BufferAttribute(fCol, 3));
    const fMat = new THREE.PointsMaterial({ vertexColors: true, size: 1.2, transparent: true });
    const flowers = new THREE.Points(fGeo, fMat);
    flowerPlanet.add(flowers);
}

// Comet
const cometTexture = textureLoader.load("comet.png");
const cometVisual = new THREE.Mesh(new THREE.CircleGeometry(2.2,48), new THREE.MeshBasicMaterial({map:cometTexture, transparent:true}));
const cometHitbox = new THREE.Mesh(new THREE.SphereGeometry(4.5,16,16), new THREE.MeshBasicMaterial({visible:false}));
const cometGroup = new THREE.Group();
cometGroup.add(cometVisual, cometHitbox);
scene.add(cometGroup);
cometGroup.position.set(70,50,-25);

let cometBurst = false;
let burstProgress = 0;
let fadeOutTimer = null;
let heartClicked = false;

const ourPhoto = textureLoader.load("our.png");
const photoMesh = new THREE.Mesh(
    new THREE.PlaneGeometry(14,9),
    new THREE.MeshBasicMaterial({map:ourPhoto, transparent:true, opacity:1})
);
photoMesh.visible = false;
scene.add(photoMesh);

const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();

window.addEventListener('click', e => {
    mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
    raycaster.setFromCamera(mouse, camera);

    if (!cometBurst) {
        if (raycaster.intersectObject(cometHitbox).length > 0) burstComet();
    } else if (flyingHeart && raycaster.intersectObject(flyingHeart.children[0]).length > 0 && !heartClicked) {
        heartClicked = true;
        createFlowerPlanet();
        targetCameraPosition.set(0, 40, 80);
        animatingCamera = true;
        document.getElementById("envelopeTextContainer").classList.remove("show");
    } else if (flowerPlanet && raycaster.intersectObject(flowerPlanet).length > 0) {
        planetClickCount++;
        flowerPlanet.scale.set(1.05, 1.05, 1.05);
        setTimeout(() => flowerPlanet.scale.set(1,1,1), 300);

        const msg = flowerMessages[Math.floor(Math.random() * flowerMessages.length)];
        const div = document.createElement('div');
        div.className = 'flower-msg';
        div.innerText = msg;
        document.body.appendChild(div);

        const rect = renderer.domElement.getBoundingClientRect();
        div.style.left = `${e.clientX - rect.left}px`;
        div.style.top = `${e.clientY - rect.top}px`;

        setTimeout(() => div.style.opacity = 1, 100);
        setTimeout(() => {
            div.style.opacity = 0;
            setTimeout(() => div.remove(), 2000);
        }, 6000);

        if (planetClickCount >= 4) {
            renderer.setClearColor(0x4b0082, 0.4);

            // Promise Ring
            const ringGeo = new THREE.TorusGeometry(35, 2, 16, 100);
            const ringMat = new THREE.MeshBasicMaterial({ color: 0xffd700, transparent: true, opacity: 0.8 });
            const ring = new THREE.Mesh(ringGeo, ringMat);
            ring.position.set(0, 0, -220);
            ring.rotation.x = Math.PI / 2;
            scene.add(ring);

            // Sparkles
            const sparkleCount = 300;
            const sGeo = new THREE.BufferGeometry();
            const sPos = new Float32Array(sparkleCount * 3);
            for (let i = 0; i < sparkleCount * 3; i += 3) {
                const r = 38 + Math.random() * 5;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                sPos[i]     = r * Math.sin(phi) * Math.cos(theta);
                sPos[i + 1] = r * Math.sin(phi) * Math.sin(theta);
                sPos[i + 2] = r * Math.cos(phi) - 220;
            }
            sGeo.setAttribute('position', new THREE.BufferAttribute(sPos, 3));
            const sMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.8, transparent: true });
            const sparkles = new THREE.Points(sGeo, sMat);
            scene.add(sparkles);

            // Your closing text (stays visible)
            document.getElementById("finalPromise").innerHTML = `
               Isha, this universe is ours forever.<br><br>
    With every star as my witness,<br>
    I promise to love you endlessly ‚Äî<br>
    not only for your breathtaking beauty,<br>
    but for the incredible human you are.<br><br>
    Every moment, every heartbeat, every memory ‚Äî<br>
    from our first laugh to forever ‚Äî<br>
    you're my whole sky.<br><br>
    Whenever you're ready,<br>
    you decide the start of our forever... üíç‚ú®<br><br>
    Forever yours,<br>
    Vansh ‚ô°
            `;
            setTimeout(() => document.getElementById("finalPromise").style.opacity = 1, 2000);

            // Bouquet signing off (after your text)
            setTimeout(() => {
                // Bouquet particles
                const bouquetCount = 800;
                const bGeo = new THREE.BufferGeometry();
                const bPos = new Float32Array(bouquetCount * 3);
                const bCol = new Float32Array(bouquetCount * 3);
                for (let i = 0; i < bouquetCount; i++) {
                    const i3 = i * 3;
                    const r = 10 + Math.random() * 20;
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.random() * Math.PI;
                    bPos[i3]     = r * Math.sin(phi) * Math.cos(theta);
                    bPos[i3 + 1] = r * Math.sin(phi) * Math.sin(theta) + 10;
                    bPos[i3 + 2] = r * Math.cos(phi) - 220;

                    const mix = Math.random();
                    let c = mix < 0.4 ? new THREE.Color(0xff69b4) : mix < 0.7 ? new THREE.Color(0xffffff) : new THREE.Color(0xff1493);
                    bCol[i3] = c.r; bCol[i3+1] = c.g; bCol[i3+2] = c.b;
                }
                bGeo.setAttribute('position', new THREE.BufferAttribute(bPos, 3));
                bGeo.setAttribute('color', new THREE.BufferAttribute(bCol, 3));
                const bMat = new THREE.PointsMaterial({ vertexColors: true, size: 1.0, transparent: true });
                const bouquetParticles = new THREE.Points(bGeo, bMat);
                bouquetParticles.position.set(0, -20, -220);
                scene.add(bouquetParticles);

                // Her photos bloom from bouquet
                const herPhotos = [
                    { file: "photo1.jpg", delay: 1500 },
                    { file: "photo2.jpg", delay: 2500 },
                    { file: "our.png", delay: 3500 }
                ];
                herPhotos.forEach((p, idx) => {
                    setTimeout(() => {
                        const tex = textureLoader.load(p.file);
                        const plane = new THREE.Mesh(
                            new THREE.PlaneGeometry(15, 15),
                            new THREE.MeshBasicMaterial({ map: tex, transparent: true, opacity: 0 })
                        );
                        plane.position.set(
                            (Math.random() - 0.5) * 40,
                            (Math.random() - 0.5) * 40 + 30,
                            -220 + (Math.random() - 0.5) * 20
                        );
                        scene.add(plane);

                        let op = 0;
                        const fadeIn = setInterval(() => {
                            op += 0.02;
                            plane.material.opacity = op;
                            if (op >= 1) clearInterval(fadeIn);
                        }, 50);

                        const floatUp = setInterval(() => {
                            plane.position.y += 0.1;
                            if (plane.position.y > 100) clearInterval(floatUp);
                        }, 30);
                    }, p.delay);
                });

                // Show bouquet emoji fallback
                document.getElementById("bouquetFinal").style.opacity = 1;
                document.getElementById("bouquetFinal").style.transform = "translate(-50%, -50%) scale(1.2)";

                // Ring floats
                const ringFloat = setInterval(() => {
                    ring.position.z += 1.2;
                    ring.rotation.z += 0.01;
                    sparkles.rotation.y += 0.005;
                    if (ring.position.z > 30) clearInterval(ringFloat);
                }, 30);

                // Final fade after 25 seconds
                setTimeout(() => {
                    scene.remove(ring);
                    scene.remove(sparkles);
                    scene.remove(bouquetParticles);
                    document.getElementById("bouquetFinal").style.opacity = 0;
                    renderer.setClearColor(0x000000);
                }, 25000);
            }, 8000); // starts 8 seconds after your text
        }
    }
});

function burstComet() {
    cometBurst = true;
    scene.remove(cometGroup);
    photoMesh.visible = true;
    photoMesh.position.set(0,0,0);
    photoMesh.scale.set(0.1,0.1,1);
    photoMesh.material.opacity = 1;

    removeOrbit();

    document.getElementById("orbitText").style.opacity = "0";
    setTimeout(() => document.getElementById("orbitText").style.display = "none", 800);

    document.getElementById("burstText").style.opacity = "1";
    document.getElementById("backToOrbit").style.display = "block";

    targetCameraPosition.set(0,0,6);
    animatingCamera = true;

    fadeOutTimer = setTimeout(() => {
        let opacity = 1;
        const fadeInterval = setInterval(() => {
            opacity -= 0.015;
            photoMesh.material.opacity = opacity;
            document.getElementById("burstText").style.opacity = opacity;

            if (opacity <= 0) {
                clearInterval(fadeInterval);
                photoMesh.visible = false;

                createNebula();
                let nebOpacity = 0;
                const nebFade = setInterval(() => {
                    nebOpacity += 0.008;
                    nebulaParticles.material.opacity = nebOpacity;
                    if (nebOpacity >= 0.8) {
                        clearInterval(nebFade);
                        setTimeout(() => {
                            document.getElementById("envelopeTextContainer").classList.add("show");
                            setTimeout(createFlyingHeart, 3000);
                        }, 1500);
                    }
                }, 40);
            }
        }, 30);
    }, 10000);
}

let animatingCamera = false;
const targetCameraPosition = new THREE.Vector3();
const cameraLerpSpeed = 0.015;

document.getElementById("backToOrbit").addEventListener("click", () => {
    clearTimeout(fadeOutTimer);
    targetCameraPosition.set(0,0,10);
    animatingCamera = true;
    document.getElementById("backToOrbit").style.display = "none";

    createOrbit();

    document.getElementById("orbitText").style.display = "block";
    setTimeout(() => document.getElementById("orbitText").style.opacity = "1", 100);

    photoMesh.visible = false;
    photoMesh.material.opacity = 1;
    document.getElementById("burstText").style.opacity = "0";
    document.getElementById("envelopeTextContainer").classList.remove("show");
    document.getElementById("finalPromise").style.opacity = 0;
    document.getElementById("bouquetFinal").style.opacity = 0;

    if (nebulaParticles) {
        scene.remove(nebulaParticles);
        nebulaParticles = null;
    }

    if (flyingHeart) {
        scene.remove(flyingHeart);
        flyingHeart = null;
    }

    if (flowerPlanet) {
        scene.remove(flowerPlanet);
        flowerPlanet = null;
    }

    heartClicked = false;
    cometBurst = false;
    burstProgress = 0;
    planetClickCount = 0;

    cometGroup.position.set(70,50,-25);
    scene.add(cometGroup);
});

// Animation loop
function animate() {
    requestAnimationFrame(animate);

    if (nebulaParticles) {
        nebulaParticles.rotation.y += 0.00004;
        nebulaParticles.rotation.x += 0.00002;
    }

    stars.rotation.y += 0.0003;

    if (flyingHeart) {
        flyingHeart.position.x += 0.12;
        flyingHeart.position.y += Math.sin(Date.now() * 0.001) * 0.15;
        flyingHeart.rotation.y += 0.005;
        if (flyingHeart.position.x > 120) flyingHeart.position.x = -120;
    }

    plane1.rotation.y += 0.0015;
    plane2.rotation.y -= 0.0015;

    if (orbitMode && sun && earth) {
        angle += 0.008;
        earth.position.x = 5 * Math.cos(angle);
        earth.position.y = 5 * Math.sin(angle);
    }

    if (!cometBurst) {
        cometGroup.position.x -= 0.025;
        cometGroup.position.y -= 0.018;
        if (cometGroup.position.x < -100 || cometGroup.position.y < -80) cometGroup.position.set(70,50,-25);
    }

    if (cometBurst && burstProgress < 1) {
        burstProgress += 0.012;
        const ease = 1 - Math.pow(1 - burstProgress, 3);
        photoMesh.scale.set(ease*1.1, ease*1.1, 1);
    }

    if (animatingCamera) {
        camera.position.lerp(targetCameraPosition, cameraLerpSpeed);
        controls.target.lerp(flowerPlanet ? flowerPlanet.position : new THREE.Vector3(0,0,0), cameraLerpSpeed);
        if (camera.position.distanceTo(targetCameraPosition) < 0.1) animatingCamera = false;
    }

    controls.update();
    renderer.render(scene, camera);
}
animate();

// Proposal timer + No button
setTimeout(() => document.getElementById("proposalBox").style.display = "block", 20000);

document.getElementById("noBtn").addEventListener("mouseover", () => {
    const x = Math.random() * (window.innerWidth - 220);
    const y = Math.random() * (window.innerHeight - 120);
    document.getElementById("noBtn").style.position = "absolute";
    document.getElementById("noBtn").style.left = `${x}px`;
    document.getElementById("noBtn").style.top = `${y}px`;
});

window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>